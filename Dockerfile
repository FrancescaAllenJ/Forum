# ----------------------------------------------------
# 1. Use official Go image (Go 1.24+ required)
# ----------------------------------------------------
FROM golang:1.24

# ----------------------------------------------------
# 2. Create working directory
# ----------------------------------------------------
WORKDIR /app

# ----------------------------------------------------
# 3. Copy Go mod files & download dependencies
# ----------------------------------------------------
COPY go.mod go.sum ./
RUN go mod download

# ----------------------------------------------------
# 4. Copy project files
# ----------------------------------------------------
COPY . .

# ----------------------------------------------------
# 5. Build binary
# ----------------------------------------------------
RUN go build -o forum .

# ----------------------------------------------------
# 6. Expose app port
# ----------------------------------------------------
EXPOSE 8080

# ----------------------------------------------------
# 7. Start server
# ----------------------------------------------------
CMD ["./forum"]
